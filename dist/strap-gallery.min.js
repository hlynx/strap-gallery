/*!
 * StrapGallery v0.1.0
 * https://github.com/hlynx/strap-gallery.git
 * Copyright 2014 hlynx <hlynx@users.noreply.github.com>
 */
!function(){function a(a,b,c,d,e){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"/src/template.html",link:function(a,d){function f(){if(!i){j=d.find("img"),a.imagesCount=j.length;for(var b=0;b<a.imagesCount;b++)j[b].dataset.id=b;i=!0}}function g(b){var c=j[b].dataset.source;e.load(c).then(function(){a.src=c,a.title="Фотографии: ",a.currentId=b},function(){})}function h(b){return k.$isShown?void(37===b.keyCode?a.$apply(function(){a.prev()}):39===b.keyCode?a.$apply(function(){a.next()}):27===b.keyCode&&a.$apply(function(){k.hide()})):!1}var i=!1,j=[];a.currentId=0;var k=b({scope:a,template:"/src/modal.html",show:!1,animation:"am-fade-and-scale",placement:"center"});c.on("keypress",h),a.$on("$destroy",function(){c.off("keypress",h)}),a.next=function(){g(a.currentId===a.imagesCount-1?0:a.currentId+1)},a.prev=function(){g(0===a.currentId?a.imagesCount-1:a.currentId-1)},a.onClick=function(a){if(i||(f(),i=!0),"IMG"===a.target.tagName){var b=parseInt(a.target.dataset.id);k.$promise.then(function(){k.show(),g(b)})}},a.$on("modal.show",function(){}),a.$on("modal.close",function(){})}}}angular.module("strapGallery",["mgcrea.ngStrap.modal","ngAnimate"]).directive("strapGallery",["$log","$modal","$document","$timeout","ImageLoader",a])}(),angular.module("strapGallery").service("ImageLoader",["$q",function(a){this.load=function(b){var c=a.defer(),d=new Image;return d.onload=function(){("boolean"==typeof this.complete&&this.complete===!1||"number"==typeof this.naturalWidth&&0===this.naturalWidth)&&c.reject(),c.resolve(d)},d.onerror=function(){c.reject()},d.src=b,c.promise}}]),angular.module("strapGallery").run(["$templateCache",function(a){"use strict";a.put("/src/modal.html",'<div class="modal strap-gallery-modal" tabindex="-1" role="dialog">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header" ng-show="title">\n                <button type="button" class="close" ng-click="$hide()">&times;</button>\n                <h4 class="modal-title" ng-bind="title"></h4>\n            </div>\n\n            <div class="modal-body">\n                <div class="strap-gallery-img-outer">\n                    <div class="arrow next" ng-click="next()"><span class="glyphicon glyphicon-chevron-right"></span></div>\n                    <div class="arrow prev" ng-click="prev()"><span class="glyphicon glyphicon-chevron-left"></span></div>\n                    <img class="strap-gallery-img" id="strap-gallery-img" ng-src="{{ src }}">\n                </div>\n            </div>\n            <div class="modal-footer">\n                {{ currentId + 1 }} из {{ imagesCount }}\n            </div>\n        </div>\n    </div>\n</div>\n'),a.put("/src/template.html",'<div class="strap-gallery" ng-click="onClick($event)">\n    <div ng-transclude></div>\n</div>')}]);