/*!
 * StrapGallery v0.2.1
 * https://github.com/hlynx/strap-gallery.git
 * Copyright 2015 hlynx <hlynx@users.noreply.github.com>
 */
!function(){function a(a,b,c){return{restrict:"EA",replace:!0,scope:{source:"="},transclude:!0,templateUrl:"/src/template.html",link:function(d,e){function f(){k||(g(),d.$on("strap-gallery:reload",function(){g()}),d.$on("$destroy",function(){b.off("keypress",j)}),k=!0)}function g(){l=e.find("img"),d.imagesCount=l.length;for(var a=0;a<d.imagesCount;a++)l[a].dataset.id=a}function h(a){var b=l[a].dataset.source;c.load(b).then(function(){d.src=b,d.title=l[a].dataset.title,d.currentId=a,i(a+1)},function(){})}function i(a){a>=d.imagesCount-1&&(a=0);var b=l[a].dataset.source;c.load(b)}function j(a){m.$isShown&&(37===a.keyCode?d.$apply(function(){d.prev()}):39===a.keyCode?d.$apply(function(){d.next()}):27===a.keyCode&&d.$apply(function(){m.hide()}))}var k=!1,l=[];d.currentId=0;var m=a({scope:d,template:"/src/modal.html",show:!1});b.on("keypress",j),d.next=function(){h(d.currentId===d.imagesCount-1?0:d.currentId+1)},d.prev=function(){h(0===d.currentId?d.imagesCount-1:d.currentId-1)},d.onClick=function(a){if(k||(f(),k=!0),"IMG"===a.target.tagName){var b=parseInt(a.target.dataset.id);m.$promise.then(function(){m.show(),h(b)})}}}}}angular.module("strapGallery",["mgcrea.ngStrap.modal","ngAnimate"]).directive("strapGallery",["$modal","$document","ImageLoader",a])}(),angular.module("strapGallery").service("ImageLoader",["$q",function(a){this.load=function(b){var c=a.defer(),d=new Image;return d.onload=function(){("boolean"==typeof this.complete&&this.complete===!1||"number"==typeof this.naturalWidth&&0===this.naturalWidth)&&c.reject(),c.resolve(d)},d.onerror=function(){c.reject()},d.src=b,c.promise}}]),angular.module("strapGallery").run(["$templateCache",function(a){"use strict";a.put("/src/modal.html",'<div class="modal strap-gallery-modal" tabindex="-1" role="dialog">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header" ng-show="title">\n                <button type="button" class="close" ng-click="$hide()">&times;</button>\n                <h4 class="modal-title" ng-bind="title"></h4>\n            </div>\n\n            <div class="modal-body">\n                <div class="strap-gallery-img-outer">\n                    <div class="arrow next" ng-click="next()"><span class="glyphicon glyphicon-chevron-right"></span></div>\n                    <div class="arrow prev" ng-click="prev()"><span class="glyphicon glyphicon-chevron-left"></span></div>\n                    <img class="strap-gallery-img" id="strap-gallery-img" ng-src="{{ src }}">\n                </div>\n            </div>\n            <div class="modal-footer">\n                {{ currentId + 1 }} / {{ imagesCount }}\n            </div>\n        </div>\n    </div>\n</div>\n'),a.put("/src/template.html",'<div class="strap-gallery" ng-click="onClick($event)">\n    <div ng-transclude></div>\n</div>')}]);